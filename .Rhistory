pivot_wider(names_from = "year",
values_from = "average_enterococci_cfu_100ml")
sydneybeaches_year_wide
sydneybeaches_mean <- sydneybeaches_year %>%
group_by(year, site) %>%
summarize(average_enterococci_cfu_100ml=mean(enterococci_cfu_100ml, na.rm=T))
sydneybeaches_mean
sydneybeaches_year_wide <- sydneybeaches_mean %>%
pivot_wider(names_from = "site",
values_from = "average_enterococci_cfu_100ml")
sydneybeaches_year_wide
sydneybeaches_year_wide %>%
filter("2018") %>%
arrange(average_enterococci_cfu_100ml)
sydneybeaches_year_wide %>%
filter(year == 2018) %>%
arrange(average_enterococci_cfu_100ml)
sydneybeaches_mean %>%
filter(year == 2018) %>%
arrange(average_enterococci_cfu_100ml)
sydneybeaches_mean %>%
filter(year == 2018) %>%
arrange(desc(average_enterococci_cfu_100ml))
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
filter(class == "Aves", "Mammalia", "Reptilia")
library(tidyverse)
library(janitor)
library(skimr)
amniota <- readr::read_csv("data/amniota.csv")
amphibio<- readr::read_csv("data/amphibio.csv")
summary(amniota)
amniota %>%
skimr::skim()
#Curious where -30259 came from, maybe multiple -999 recordings?
-30259/-999
amniota_no_nas <- amniota %>%
na_if("-999")
summary(amniota_no_nas)
#Trying to figure out what -30258.71100 is
amniota_no_nas %>%
filter(female_maturity_d >= 50) %>%
tabyl(female_maturity_d)
#this might be what you were trying to do?
#What Min-Yao suggested for getting rid of that one negative value:
amniota_na <- amniota %>%
na_if("-999") %>% #converts all -999 values to NA
mutate(female_maturity_d_new = ifelse(female_maturity_d < 0, NA, female_maturity_d)) %>%
select(-female_maturity_d)
amniota_na %>%
summarize(number_nas = sum(is.na(amniota_na)))
summary(amphibio)
glimpse(amphibio)
hist(amphibio$Aqu)
naniar::miss_var_summary(amphibio)
amniota %>%
summarize(number_nas = sum(is.na(amniota)))
amphibio %>%
summarize(number_nas = sum(is.na(amphibio)))
#What Min-Yao suggested for getting rid of that one negative value:
amniota_na <- amniota %>%
na_if("-999") %>% #converts all -999 values to NA
mutate(female_maturity_d_new = ifelse(female_maturity_d < 0, NA, female_maturity_d)) %>%
select(-female_maturity_d)
amniota_na %>%
summarize(number_nas = sum(is.na(amniota_na)))
amphibio_na <- amphibio %>%
na_if("0")
amphibio_na %>%
summarize(number_nas = sum(is.na(amphibio_na)))
naniar::miss_var_summary(amniota_na)
naniar::miss_var_summary(amphibio_na)
amniota
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
filter(class == "Aves", "Mammalia", "Reptilia")
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
select(class == "Aves", "Mammalia", "Reptilia")
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
select("Aves", "Mammalia", "Reptilia")
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
filter("Aves", "Mammalia", "Reptilia")
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
filter(Aves, Mammalia, Reptilia)
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
filter(class == Aves, Mammalia, Reptilia)
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
filter(class == "Aves", "Mammalia", "Reptilia")
amniota %>%
group_by(class) %>%
select(class, egg_mass_g) %>%
naniar::miss_var_summary(order=T)
amniota %>%
select(class, egg_mass_g) %>%
any
amniota %>%
select(class, egg_mass_g) %>%
naniar::miss_var_summary(order=T)
amniota_na %>%
select(class, egg_mass_g) %>%
naniar::miss_var_summary(order=T)
amphibio
amphibio_na %>%
select(Fos, Ter, Aqu, Arb)
amphibio_na %>%
select(Fos, Ter, Aqu, Arb) %>%
naniar::miss_var_summary(order=T)
amniota_converted_na <-
readr::read_csv(file = "data/amniota.csv", na = c("-999"))
knitr::opts_chunk$set(echo = TRUE)
deserts %>%
filter(genus=="Dipodomys" & species=="merriami") %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
deserts %>%
filter(genus=="Dipodomys" & species=="merriami") %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
deserts %>%
filter(genus=="Dipodomys" & species=="merriami") %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
deserts %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
deserts %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
library(tidyverse)
library(janitor)
library(here)
library(naniar)
deserts <- read_csv(here("lab10", "data", "surveys_complete.csv"))
deserts
deserts %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
theme(plot.title = element_text(size = rel(1.5), hjust = 0.5))
deserts %>%
filter(genus=="Dipodomys" & species=="merriami") %>%
ggplot(aes(x = year, fill = species)) + geom_bar() + scale_y_log10() +
labs(title = "Observations of Dipodomys merriami over time",
x = "Year",
fill = "Dipodomys merriami")
theme(plot.title = element_text(size = rel(1.5), hjust = 0.5))
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
options(scipen=999) #cancels the use of scientific notation for the session
deserts <- read_csv(here("lab11", "data", "surveys_complete.csv"))
homerange <- read_csv(here("lab11", "data", "Tamburelloetal_HomeRangeDatabase.csv"))
deserts %>%
filter(species_id=="DM" | species_id=="DS") %>% #Filtering out two species
group_by(year, species_id) %>%
summarise(n=n())
#How many times were those species collected or observed over the years?
deserts %>%
filter(species_id=="DM" | species_id=="DS") %>%
group_by(year, species_id) %>%
summarise(n=n()) %>%
ggplot(aes(x=year, y=n))+
geom_line()+
geom_point(shape=1)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
labs(title = "Number of samples for species DM",
x = "Year",
fill = "n")
deserts %>%
filter(species_id=="DM" | species_id=="DS") %>%
group_by(year, species_id) %>%
summarise(n=n()) %>%
ggplot(aes(x=year, y=n, group=species_id, color=species_id))+
geom_line()+
geom_point(shape=1)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
labs(title = "Number of samples for species DM",
x = "Year",
fill = "n")
glimspe(deserts)
glimpse(deserts)
deserts$year <- as.factor(deserts$year)
deserts %>%
filter(species_id=="DM" | species_id=="DS") %>%
group_by(year, species_id) %>%
summarise(n=n()) %>%
ggplot(aes(x=year, y=n, group=species_id, color=species_id))+
geom_line()+
geom_point(shape=1)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
labs(title = "Number of samples for species DM",
x = "Year",
fill = "n")
#X axis shown in years and broken up into increments of 5.
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(alpha = 0.6, color = "black", fill = "deeppink4", bins=40)+
labs(title = "Distribution of Body Mass")
grDevices::colors()
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(alpha = 0.6, color = "black", fill = "deepskyblue4", bins=40)+
labs(title = "Distribution of Body Mass")
#Each bar is a bin and has a black line across it, helps it pop out a bit more
#Color option changes outline. This helps make the bins more clearly
#Fill has a lot of colors for RStudio!
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(alpha = 0.9, color = "black", fill = "deepskyblue4", bins=40)+
labs(title = "Distribution of Body Mass")
#Each bar is a bin and has a black line across it, helps it pop out a bit more
#Color option changes outline. This helps make the bins more clearly
#Fill has a lot of colors for RStudio!
#Alpha refers to transparency
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_density(fill="steelblue", alpha  =0.6, color = "black")+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_histogram(alpha = 0.7, color = "black", fill = "deepskyblue4", bins=40)+
labs(title = "Distribution of Body Mass")
#Each bar is a bin and has a black line across it, helps it pop out a bit more
#Color option changes outline. This helps make the bins more clearly
#Fill has a lot of colors for RStudio!
#Alpha refers to transparency. Some transparency lets readers see lines behind plot
homerange %>%
ggplot(aes(x = log10.mass)) +
geom_density(fill="steelblue", alpha  =0.7, color = "black")+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_histogram(aes(y = ..density..), fill = "steelblue", alpha = 0.7, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_histogram(aes(y = ..density..), binwidth = .4, fill = "steelblue", alpha = 0.7, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram(fill=deepskyblue4, alpha=0.7, color="black")+
labs(title="Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram(fill="deepskyblue4", alpha=0.7, color="black")+
labs(title="Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram(fill="deepskyblue4", alpha=0.7, color="black", bins=40)+
labs(title="Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_density(fill="deepskyblue4", alpha=0.7, color="black", bins=40)+
labs(title="Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.hra)) +
geom_histogram(aes(y = ..density..), binwidth = .4, fill = "steelblue", alpha = 0.7, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of Homerange")
glimpse(homerange)
homerange %>%
select(log10.mass) %>%
summarise(min=min(log10.mass),
max=max(log10.mass))
#Breaking up data with continuous variables
summary(homerange$log10.mass)
homerange <- homerange %>%
mutate(mass_category = case_when(log10.mass <= 1.75 ~ "small",
log10.mass > 1.75 & log10.mass <= 2.75 ~ "medium",
log10.mass > 2.75 ~ "large"))
#Mutating to add a new column, and making mass categories
#Case_when categorized variables
homerange <- homerange %>%
mutate(mass_category = case_when(log10.mass <= 1.75 ~ "small",
log10.mass > 1.75 & log10.mass <= 2.75 ~ "medium",
log10.mass > 2.75 ~ "large"))
#Mutating to add a new column, and making mass categories
#Case_when categorized variables
glimpse(homerange)
homerange %>%
ggplot(aes(x = mass_category, fill = trophic.guild)) +
geom_bar() +
coord_flip() +
labs(title = "Observations by Taxon and Mass Category in Homerange Data",
x = "Mass Category",
fill = "Trophic Guild")
homerange %>%
ggplot(aes(x = mass_category, fill = trophic.guild)) +
geom_bar(position="dodge") +
coord_flip() +
labs(title = "Observations by Taxon and Mass Category in Homerange Data",
x = "Mass Category",
fill = "Trophic Guild")
#Made mass category into a categorical variable
homerange %>%
ggplot(aes(x = mass_category, fill = trophic.guild)) +
geom_bar(position="dodge") +
labs(title = "Observations by Taxon and Mass Category in Homerange Data",
x = "Mass Category",
fill = "Trophic Guild")
#Made mass category into a categorical variable
summary(homerange$log10.hra)
library(gtools)
library(gtools)
quartiles<-quantcut(homerange$log10.hra)
library(gtools)
quartiles<-quantcut(homerange$log10.hra)
tabyl(quartiles)
library(gtools)
quartiles<-quantcut(homerange$log10.hra)
table(quartiles)
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
options(scipen=999) #cancels the use of scientific notation for the session
homerange <- read_csv(here("lab11", "data", "Tamburelloetal_HomeRangeDatabase.csv"))
p <- homerange %>%
ggplot(aes(x=taxon, fill=trophic.guild))+
geom_bar(na.rm=T, position="dodge")
p
p+theme_linedraw()+
theme(axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
p+theme_linedraw()+
theme(legend.position = "bottom", #By defualt, legend will be "right"
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
#If you want to get rid of them, enter a tick, 'none'
p+theme_linedraw()+
theme(legend.position = 'none', #By defualt, legend will be "right"
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
#install.packages("ggthemes")
library(ggthemes)
install.packages("ggthemes")
library(ggthemes)
install.packages("ggthemes")
ls("package:ggthemes")[grepl("theme_", ls("package:ggthemes"))]
p+ theme_pander()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
?RColorBrewer
display.brewer.pal(8,"PRGn")
#Pick a palette, type in number of variables you intend on including (8 color palette for PRGn)
display.brewer.pal(8,"RdGy")
#Pick a palette, type in number of variables you intend on including (8 color palette for PRGn)
p+scale_fill_brewer(palette = "Paired")+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
colors <- paletteer::palettes_d_names
colors <- paletteer::palettes_d_names
view(colors)
my_palette <- paletteer_d("ggsci::hallmarks_light_cosmic")
barplot(rep(1,14), axes=FALSE, col=my_palette)
p+scale_fill_manual(values=my_palette)+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 60, hjust=1))+
labs(title = "Observations by Taxon in Homerange Data",
x = NULL,
y= "n",
fill= "Trophic Guild")
homerange %>%
ggplot(aes(x = log10.mass, y = log10.hra, color = locomotion)) +
geom_point() +
xlim(0, 4) +
ylim(1, 6)
homerange %>%
ggplot(aes(x = log10.mass, y = log10.hra, color = locomotion)) +
geom_point()
glimpse(homerange)
p2 <- homerange %>%
ggplot(aes(x = log10.mass)) +
geom_density()
#Basically building a series of plots stacked all at once
#So we're doing density distribution for now
p2+ facet_wrap(~taxon)
p2+ facet_wrap(~class)
p2+facet_grid(thermoregulation~class)
#So two caterogical variables!
#Use facet_grid for 2 categorical variables
homerange %>%
ggplot(aes(x = log10.mass, y = log10.hra, color = locomotion)) +
geom_point() +
annotate("text", label="r^2==0", parse=T, x=6, y=0)
homerange %>%
ggplot(aes(x=log10.mass, y=log10.hra, color=class))+
geom_point()
homerange %>%
ggplot(aes(x = log10.mass, y = log10.hra, color = class))+
geom_point()+
scale_color_brewer(palette = "BrBG")
homerange %>%
ggplot(aes(x = trophic.guild, y = class))+
geom_bar(position="dodge", alpha = 0.75, color = "black")
homerange %>%
ggplot(aes(x = trophic.guild, y = class))+
geom_col(position="dodge", alpha = 0.75, color = "black")
homerange %>%
ggplot(aes(x = trophic.guild, y = class))+
geom_col(position="dodge", alpha = 0.75, color = "black")+
scale_fill_brewer(palette = "BrBG")
homerange %>%
ggplot(aes(x = trophic.guild, y = class, fill = class))+
geom_col(position="dodge", alpha = 0.75, color = "black")+
scale_fill_brewer(palette = "BrBG")
homerange <- homerange %>%
mutate(range_category= case_when(log10.hra<3.65 ~ "very small",
log10.hra>=3,65 & log10.hra<4.49 ~ "small",#next quartile
log10.hra>=4.49 & log10.hra<6.02 ~ "medium",
log10.hra>=6.02 ~ "large"))
homerange <- homerange %>%
mutate(range_category= case_when(log10.hra<3.65 ~ "very small",
log10.hra>=3.65 & log10.hra<4.49 ~ "small",#next quartile
log10.hra>=4.49 & log10.hra<6.02 ~ "medium",
log10.hra>=6.02 ~ "large"))
#3.65 is the quartile value in the first column/row, "y" value
glimpse(homerange)
homerange %>%
ggplot(aes(x = range_category, fill = class))+
geom_bar(position="dodge")
homerange %>%
filter(range_category=="small")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x = class, y = log10.mass, fill = class))+
geom_boxplot(alpha = 0.6)
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x = class, y = log10.mass, fill = class))+
geom_boxplot(alpha = 0.7)
knitr::opts_chunk$set(echo = TRUE)
getwd()
knitr::opts_chunk$set(echo = TRUE)
getwd()
setwd("~/Desktop/GitHub/BIS15L_Project_Group11")
getwd()
asd_meta_abundance <- read_csv(here("ASD meta abundance 2.csv"))
library(tidyverse)
library(janitor)
library(here)
library(naniar)
asd_meta_abundance <- read_csv(here("ASD meta abundance 2.csv"))
asd_meta_abundance
glimpse(asd_meta_abundance)
asd_meta_abundance <- read_csv(here("ASD meta abundance 2.csv"))
asd_meta_abundance
names(asd_meta_abundance)
knitr::opts_chunk$set(echo = TRUE)
getwd()
```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(janitor)
library(here)
library(naniar)
gse <- read_csv(here("GSE113690_Autism_16S_rRNA_OTU_assignment_and_abundance.csv"))
gse
glimpse(gse)
asd <- read_csv(here("ASD meta abundance 2.csv"))
asd
glimpse(asd)
names(asd)
summary(asd)
summary(gse)
summary(gse)
