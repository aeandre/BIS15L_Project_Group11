knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
options(scipen=999) #disables scientific notation when printing
population <- read_csv("data/population_total.csv")
population
income <- read_csv("data/income_per_person_gdppercapita_ppp_inflation_adjusted.csv")
income
life_expectancy <- read_csv("data/life_expectancy_years.csv")
life_expectancy
head(population)
naniar::miss_var_summary(population)
population_tidy <- population %>%
pivot_longer(-country, names_to = "year", values_to = "population")
population_tidy
head(income)
naniar::miss_var_summary(income)
income_tidy <- income %>%
pivot_longer(-country, names_to = "year", values_to = "income")
income_tidy
head(life_expectancy)
naniar::miss_var_summary(life_expectancy)
life_exp_tidy <- life_expectancy %>%
pivot_longer(-country, names_to = "year", values_to = "life_exp", values_drop_na = FALSE)
view(life_exp_tidy)
population_tidy %>%
summarise(n = n_distinct(country))
income_tidy %>%
summarise(n = n_distinct(country))
life_exp_tidy %>%
summarise(n = n_distinct(country))
life_exp_tidy %>%
filter(between(year, 1920,2020)) %>%
arrange(desc(life_exp))
life_exp_tidy %>%
filter(between(year, 1920,2020)) %>%
arrange(life_exp)
life_exp_growth <- life_expectancy %>%
rename("beginning" = "1920", "end" = "2020") %>%
mutate(growth = end - beginning) %>%
arrange(desc(growth))
life_exp_growth$growth
life_exp_growth %>%
select(country, growth) %>%
top_n(5)
life_exp_tidy %>%
filter(between(year, 1920, 2020), country == "Kuwait") %>%
ggplot(aes(x = year, y = life_exp)) +
geom_line(group = 1)+
theme_minimal()+
labs(title = "Life Expectancy of Kuwait over One Hundred Years", x = "Year", y = "Life Expectancy")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))
population_growth <- population %>%
rename("beginning" = "1920", "end" = "2020") %>%
mutate(growth = end - beginning) %>%
arrange(desc(growth))
population_growth %>%
select(country, growth) %>%
top_n(5)
population_tidy %>%
filter(between(year, 1920, 2020), (country == "India" | country == "China" | country == "Indonesia" | country == "United States" | country == "Pakistan")) %>%
ggplot(aes(x = year, y = population, group = country, color = country)) +
geom_line(size = 1.25)+
theme_minimal()+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))+
scale_color_brewer(palette = "Set2")+
labs(title = "Population Growth of Top 5 Countries over One Hundred Years", x = "Year", y = "Population")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))
income_growth <- income %>%
rename("beginning" = "1920", "end" = "2020") %>%
mutate(growth = end - beginning) %>%
arrange(desc(growth))
income_growth %>%
select(country, growth) %>%
top_n(5)
income_tidy %>%
filter(between(year, 1920, 2020), (country == "Qatar" | country == "Luxembourg" | country == "Singapore" | country == "Brunei" | country == "Ireland")) %>%
ggplot(aes(x = year, y = income, group = country, color = country)) +
geom_line(size = 1.25)+
theme_minimal()+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))+
scale_color_brewer(palette = "Set2")+
labs(title = "GDP per Capita Growth of Top 5 Countries over One Hundred Years", x = "Year", y = "GDP per Capita")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))
life_expectancy_100 <- life_exp_tidy %>%
filter(between(year, 1920, 2020))
population_100 <- population_tidy %>%
filter(between(year, 1920, 2020))
income_100 <- income_tidy %>%
filter(between(year, 1920, 2020))
gapminder_join <- inner_join(life_expectancy_100, population_100, by= c("country", "year"))
gapminder_join <- inner_join(gapminder_join, income_100, by= c("country", "year"))
gapminder_join
library(gtools)
quartiles <- quantcut(gapminder_join$income)
table(quartiles)
gapminder_join_grouped <- gapminder_join %>%
mutate(income_category = case_when(income <= 1.63e+03 ~ "low", income > 1.63e+03 & income <= 3.5e+03 ~ "lower middle", income > 3.5e+03 & income <= 9.62e+03 ~ "middle", income > 9.62e+03 ~ "high")) %>%
mutate(income_category = factor(income_category, levels = c("low", "lower middle", "middle", "high")))
gapminder_join_grouped %>%
filter(between(year, 1990, 2020)) %>%
ggplot(aes(x = life_exp))+
geom_histogram(aes(y = ..density..), binwidth = 3, alpha = 0.7, color = "darkolivegreen4", fill = "darkolivegreen3", na.rm = T)+
geom_density(color = "cyan4", size = 1.05, na.rm = T)+
facet_wrap(~income_category)+
theme_minimal()+
scale_color_brewer(palette = "Set2")+
labs(title = "Distribution of Life Expectancy by Country Income Level", x = "Life Expectancy (yrs)", y = "Density")
life_expectancy <- read_csv(here("midterm2", "data", "life_expectancy_years.csv"))
income <- read_csv(here("midterm2", "data", "income_per_person_gdppercapita_ppp_inflation_adjusted.csv")
income <- read_csv(here("midterm2", "data", "income_per_person_gdppercapita_ppp_inflation_adjusted.csv"))
income <- read_csv(here("midterm2", "data", "income_per_person_gdppercapita_ppp_inflation_adjusted.csv"))
income
life_expectancy
population <- read_csv(here("midterm2", "data", "population_total.csv"))
population
glimpse(population)
summary(population)
smmary(income)
summary(income)
summary(life_expectancy)
life_exp_tidy
life_exp_tidy %>%
filter(between(year, 1920, 2020), country == "Kuwait") %>%
ggplot(aes(x = year, y = life_exp, color = life_exp)) +
geom_line(group = 1)+
theme_minimal()+
labs(title = "Life Expectancy of Kuwait over One Hundred Years", x = "Year", y = "Life Expectancy")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))
life_exp_tidy %>%
filter(between(year, 1920, 2020), country == "Kuwait") %>%
ggplot(aes(x = year, y = life_exp, color = life_exp)) +
geom_line(group = 1, size = 1.25)+
theme_minimal()+
labs(title = "Life Expectancy of Kuwait over One Hundred Years", x = "Year", y = "Life Expectancy")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))
life_exp_tidy %>%
filter(between(year, 1920, 2020), country == "Kuwait") %>%
ggplot(aes(x = year, y = life_exp, color = life_exp)) +
geom_line(group = 1, size = 1.25, color = "darksalmon4")+
theme_minimal()+
labs(title = "Life Expectancy of Kuwait over One Hundred Years", x = "Year", y = "Life Expectancy")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))
life_exp_tidy %>%
filter(between(year, 1920, 2020), country == "Kuwait") %>%
ggplot(aes(x = year, y = life_exp, color = life_exp)) +
geom_line(group = 1, size = 1.25, color = "darksalmon")+
theme_minimal()+
labs(title = "Life Expectancy of Kuwait over One Hundred Years", x = "Year", y = "Life Expectancy")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))
life_exp_tidy %>%
filter(between(year, 1920, 2020), country == "Kuwait") %>%
ggplot(aes(x = year, y = life_exp, color = life_exp)) +
geom_line(group = 1, size = 1.25)+
theme_minimal()+
labs(title = "Life Expectancy of Kuwait over One Hundred Years", x = "Year", y = "Life Expectancy")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))
population_growth <- population %>%
rename("beginning" = "1920", "end" = "2020") %>%
mutate(growth = end - beginning) %>%
arrange(desc(growth))
population_tidy %>%
filter(between(year, 1920, 2020), (country == "India" | country == "China" | country == "Indonesia" | country == "United States" | country == "Pakistan")) %>%
ggplot(aes(x = year, y = population, group = country, color = country)) +
geom_line(size = 1.25)+
theme_minimal()+
theme(axis.text.x =  element_text(angle = 60, hjust = 1), fill = "color")+
scale_color_brewer(palette = "Set2")+
labs(title = "Population Growth of Top 5 Countries over One Hundred Years", x = "Year", y = "Population")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))
population_tidy %>%
filter(between(year, 1920, 2020), (country == "India" | country == "China" | country == "Indonesia" | country == "United States" | country == "Pakistan")) %>%
ggplot(aes(x = year, y = population, group = country, color = country)) +
geom_line(size = 1.25)+
theme_minimal()+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))+
scale_color_brewer(palette = "Set2")+
labs(title = "Population Growth of Top 5 Countries over One Hundred Years", x = "Year", y = "Population", fill = "Country")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))
population_tidy %>%
filter(between(year, 1920, 2020), (country == "India" | country == "China" | country == "Indonesia" | country == "United States" | country == "Pakistan")) %>%
ggplot(aes(x = year, y = population, group = country, color = country)) +
geom_line(size = 1.25)+
theme_minimal()+
theme(axis.text.x =  element_text(angle = 60, hjust = 1))+
scale_color_brewer(palette = "Set2")+
labs(title = "Population Growth of Top 5 Countries over One Hundred Years", x = "Year", y = "Population")+
scale_x_discrete(name = "Year", breaks = seq(1920, 2020, by = 4))
